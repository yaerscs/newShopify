{%- style -%}
  .clinical-proven-{{ section.id }} {
    position: relative;
    isolation: isolate;
    color: {{ section.settings.text_color }};
    background-color: {{ section.settings.bg_color_fallback }};
    padding-top: {{ section.settings.padding_top_mobile }}px;
    padding-bottom: {{ section.settings.padding_bottom_mobile }}px;
  }

  .clinical-proven-{{ section.id }}::before {
    content: '';
    position: absolute;
    inset: 0;
    z-index: -2;
    background:
      linear-gradient(to bottom, {{ section.settings.bg_color_top }} 0%, {{ section.settings.bg_color_bottom }} 100%)
      {%- if section.settings.bg_image != blank -%},
      url({{ section.settings.bg_image | image_url: width: 2200 }})
      {%- endif -%};
    background-size: cover, {{ section.settings.bg_image_size }};
    background-position: center, {{ section.settings.bg_image_position }};
    background-repeat: no-repeat;
  }

  .clinical-proven-{{ section.id }}::after {
    content: '';
    position: absolute;
    inset: 0;
    z-index: -1;
    background: {{ section.settings.overlay_color }};
    opacity: {{ section.settings.overlay_opacity | divided_by: 100.0 }};
    pointer-events: none;
  }

  @media screen and (min-width: 750px) {
    .clinical-proven-{{ section.id }} {
      padding-top: {{ section.settings.padding_top_desktop }}px;
      padding-bottom: {{ section.settings.padding_bottom_desktop }}px;
    }
  }

  .clinical-proven-{{ section.id }} .clinical-proven__container {
    max-width: var(--page-width);
    margin: 0 auto;
    padding: 0 1.5rem;
  }

  @media screen and (min-width: 750px) {
    .clinical-proven-{{ section.id }} .clinical-proven__container {
      padding: 0 5rem;
    }
  }

  .clinical-proven-{{ section.id }} .clinical-proven__layout {
    display: flex;
    flex-direction: column-reverse;
    gap: 2.4rem;
  }

  .clinical-proven-{{ section.id }} .clinical-proven__layout--stats-first {
    flex-direction: column;
  }

  @media screen and (min-width: 990px) {
    .clinical-proven-{{ section.id }} .clinical-proven__layout,
    .clinical-proven-{{ section.id }} .clinical-proven__layout--stats-first {
      flex-direction: row;
      gap: {{ section.settings.layout_gap_desktop }}px;
      align-items: flex-start;
    }
  }

  .clinical-proven-{{ section.id }} .clinical-proven__stats {
    width: 100%;
    display: grid;
    grid-template-columns: 1fr;
    gap: 0;
  }

  @media screen and (min-width: 990px) {
    .clinical-proven-{{ section.id }} .clinical-proven__stats {
      width: {{ section.settings.stats_column_width }}%;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      column-gap: {{ section.settings.stats_column_gap }}px;
      row-gap: 0;
    }
  }

  .clinical-proven-{{ section.id }} .clinical-proven__stat {
    text-align: left;
    padding: {{ section.settings.stat_padding_vertical }}px 0;
  }

  .clinical-proven-{{ section.id }} .clinical-proven__stat + .clinical-proven__stat {
    border-top: 1px solid {{ section.settings.divider_color | color_modify: 'alpha', section.settings.divider_opacity | divided_by: 100.0 }};
  }

  @media screen and (min-width: 990px) {
    .clinical-proven-{{ section.id }} .clinical-proven__stat {
      border-top: none;
    }

    .clinical-proven-{{ section.id }} .clinical-proven__stat:nth-child(n + 3) {
      border-top: 1px solid {{ section.settings.divider_color | color_modify: 'alpha', section.settings.divider_opacity | divided_by: 100.0 }};
    }
  }

  .clinical-proven-{{ section.id }} .clinical-proven__percent {
    display: block;
    margin: 0;
    color: {{ section.settings.percent_color }};
    font-size: {{ section.settings.percent_size_mobile }}px;
    line-height: 1.1;
    font-weight: 500;
  }

  .clinical-proven-{{ section.id }} .clinical-proven__head {
    display: block;
    margin: 0.5rem 0 0;
    color: {{ section.settings.heading_color }};
    font-size: {{ section.settings.stat_heading_size }}px;
    line-height: 1.35;
    font-weight: 700;
  }

  .clinical-proven-{{ section.id }} .clinical-proven__caption {
    display: block;
    margin: 0.4rem 0 0;
    color: {{ section.settings.caption_color }};
    font-size: {{ section.settings.stat_caption_size }}px;
    line-height: 1.35;
  }

  @media screen and (min-width: 990px) {
    .clinical-proven-{{ section.id }} .clinical-proven__percent {
      font-size: {{ section.settings.percent_size_desktop }}px;
    }
  }

  .clinical-proven-{{ section.id }} .clinical-proven__cta {
    width: 100%;
    text-align: {{ section.settings.cta_text_align_mobile }};
  }

  @media screen and (min-width: 990px) {
    .clinical-proven-{{ section.id }} .clinical-proven__cta {
      width: calc(100% - {{ section.settings.stats_column_width }}% - {{ section.settings.layout_gap_desktop }}px);
      text-align: {{ section.settings.cta_text_align_desktop }};
    }
  }

  .clinical-proven-{{ section.id }} .clinical-proven__title {
    margin: 0;
    color: {{ section.settings.cta_title_color }};
    font-size: {{ section.settings.cta_title_size_mobile }}px;
    line-height: 1.2;
    font-weight: 500;
  }

  .clinical-proven-{{ section.id }} .clinical-proven__title strong {
    color: {{ section.settings.cta_title_accent_color }};
    font-weight: 500;
  }

  .clinical-proven-{{ section.id }} .clinical-proven__subtitle {
    margin: 1rem 0 0;
    color: {{ section.settings.cta_subtitle_color }};
    font-size: {{ section.settings.cta_subtitle_size }}px;
    line-height: 1.35;
  }

  .clinical-proven-{{ section.id }} .clinical-proven__button-wrap {
    margin-top: 1.6rem;
    display: flex;
    justify-content: {%- case section.settings.button_direction -%}{%- when 'left' -%}flex-start{%- when 'right' -%}flex-end{%- else -%}center{%- endcase -%};
  }

  .clinical-proven-{{ section.id }} .clinical-proven__button {
    min-height: 4.4rem;
    border-radius: {{ section.settings.button_radius }}px;
    background: {{ section.settings.button_bg_color }};
    color: {{ section.settings.button_text_color }};
    border: 1px solid {{ section.settings.button_border_color }};
    padding: 1rem 2rem;
  }

  .clinical-proven-{{ section.id }} .clinical-proven__button:hover {
    background: {{ section.settings.button_bg_hover_color }};
    color: {{ section.settings.button_text_hover_color }};
    border-color: {{ section.settings.button_border_hover_color }};
  }

  .clinical-proven-{{ section.id }} .clinical-proven__subtext {
    margin: 0.9rem 0 0;
    display: flex;
    align-items: center;
    gap: 0.6rem;
    justify-content: {%- case section.settings.button_direction -%}{%- when 'left' -%}flex-start{%- when 'right' -%}flex-end{%- else -%}center{%- endcase -%};
    color: {{ section.settings.shield_text_color }};
    font-size: {{ section.settings.shield_text_size }}px;
    line-height: 1.2;
  }

  .clinical-proven-{{ section.id }} .clinical-proven__subtext .material-symbols-outlined {
    font-size: {{ section.settings.shield_icon_size }}px;
    line-height: 1;
  }

  @media screen and (max-width: 989px) {
    .clinical-proven-{{ section.id }} .clinical-proven__button-wrap {
      justify-content: {%- case section.settings.button_direction_mobile -%}{%- when 'left' -%}flex-start{%- when 'right' -%}flex-end{%- else -%}center{%- endcase -%};
    }

    .clinical-proven-{{ section.id }} .clinical-proven__subtext {
      justify-content: {%- case section.settings.button_direction_mobile -%}{%- when 'left' -%}flex-start{%- when 'right' -%}flex-end{%- else -%}center{%- endcase -%};
    }

    .clinical-proven-{{ section.id }} .clinical-proven__button {
      width: {% if section.settings.button_full_width_mobile %}100%{% else %}auto{% endif %};
    }
  }

  @media screen and (min-width: 990px) {
    .clinical-proven-{{ section.id }} .clinical-proven__title {
      font-size: {{ section.settings.cta_title_size_desktop }}px;
    }
  }
{%- endstyle -%}

<div class="clinical-proven-{{ section.id }}">
  <div class="clinical-proven__container">
    <div class="clinical-proven__layout{% if section.settings.mobile_content_order == 'stats_first' %} clinical-proven__layout--stats-first{% endif %}">
      <div class="clinical-proven__stats" aria-label="Clinical stats">
        {%- for block in section.blocks -%}
          <div class="clinical-proven__stat" {{ block.shopify_attributes }}>
            <p class="clinical-proven__percent" data-target="{{ block.settings.percent }}">{{ block.settings.percent }}%</p>
            {%- if block.settings.heading != blank -%}
              <span class="clinical-proven__head">{{ block.settings.heading }}</span>
            {%- endif -%}
            {%- if block.settings.caption != blank -%}
              <span class="clinical-proven__caption">{{ block.settings.caption }}</span>
            {%- endif -%}
          </div>
        {%- endfor -%}
      </div>

      <div class="clinical-proven__cta">
        {%- if section.settings.cta_title != blank -%}
          <h2 class="clinical-proven__title inline-richtext">{{ section.settings.cta_title }}</h2>
        {%- endif -%}

        {%- if section.settings.cta_subtitle != blank -%}
          <div class="clinical-proven__subtitle">{{ section.settings.cta_subtitle }}</div>
        {%- endif -%}

        {%- if section.settings.button_label != blank -%}
          <div class="clinical-proven__button-wrap">
            <a
              class="button clinical-proven__button"
              {% if section.settings.button_link != blank %}
                href="{{ section.settings.button_link }}"
              {% else %}
                role="link" aria-disabled="true"
              {% endif %}
            >
              {{ section.settings.button_label }}
            </a>
          </div>
        {%- endif -%}

        {%- if section.settings.shield_text != blank -%}
          <div class="clinical-proven__subtext">
            <span class="material-symbols-outlined">verified_user</span>
            <span>{{ section.settings.shield_text }}</span>
          </div>
        {%- endif -%}
      </div>
    </div>
  </div>
</div>

{%- if section.settings.enable_count_animation -%}
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      var sectionEl = document.querySelector('.clinical-proven-{{ section.id }}');
      if (!sectionEl) return;

      var counters = sectionEl.querySelectorAll('.clinical-proven__percent');
      var duration = {{ section.settings.animation_duration }};

      var animateCount = function (el) {
        var target = parseInt(el.getAttribute('data-target') || '0', 10);
        var start = performance.now();

        var tick = function (now) {
          var progress = Math.min((now - start) / duration, 1);
          el.textContent = Math.round(target * progress) + '%';
          if (progress < 1) {
            requestAnimationFrame(tick);
          }
        };

        requestAnimationFrame(tick);
      };

      var observer = new IntersectionObserver(function (entries, obs) {
        entries.forEach(function (entry) {
          if (!entry.isIntersecting) return;
          counters.forEach(function (counter) {
            if (counter.dataset.counted === 'true') return;
            counter.dataset.counted = 'true';
            animateCount(counter);
          });
          obs.unobserve(entry.target);
        });
      }, { threshold: {{ section.settings.animation_threshold | divided_by: 100.0 }} });

      observer.observe(sectionEl);
    });
  </script>
{%- endif -%}

{% schema %}
{
  "name": "Clinical Proven Stats",
  "tag": "section",
  "class": "section",
  "disabled_on": {
    "groups": ["header", "footer"]
  },
  "settings": [
    { "type": "header", "content": "CTA content" },
    { "type": "inline_richtext", "id": "cta_title", "label": "Title", "default": "<strong>Clinically Proven.</strong> More Energy. A Healthier Gut." },
    { "type": "text", "id": "cta_subtitle", "label": "Subtitle", "default": "When clean, plant-based ingredients meet clinical potency, the results speak for themselves." },
    { "type": "range", "id": "cta_title_size_desktop", "min": 20, "max": 60, "step": 1, "unit": "px", "label": "Title size (desktop)", "default": 48 },
    { "type": "range", "id": "cta_title_size_mobile", "min": 18, "max": 44, "step": 1, "unit": "px", "label": "Title size (mobile)", "default": 32 },
    { "type": "range", "id": "cta_subtitle_size", "min": 12, "max": 28, "step": 1, "unit": "px", "label": "Subtitle size", "default": 17 },

    { "type": "header", "content": "Button" },
    { "type": "text", "id": "button_label", "label": "Button label", "default": "Try Risk-Free Today" },
    { "type": "url", "id": "button_link", "label": "Button link" },
    { "type": "select", "id": "button_direction", "label": "Button direction (desktop)", "default": "center", "options": [
      { "value": "left", "label": "Left" },
      { "value": "center", "label": "Center" },
      { "value": "right", "label": "Right" }
    ] },
    { "type": "select", "id": "button_direction_mobile", "label": "Button direction (mobile)", "default": "center", "options": [
      { "value": "left", "label": "Left" },
      { "value": "center", "label": "Center" },
      { "value": "right", "label": "Right" }
    ] },
    { "type": "checkbox", "id": "button_full_width_mobile", "label": "Full-width button on mobile", "default": true },
    { "type": "range", "id": "button_radius", "min": 0, "max": 40, "step": 1, "unit": "px", "label": "Button corner radius", "default": 6 },
    { "type": "color", "id": "button_bg_color", "label": "Button background", "default": "#d9edcf" },
    { "type": "color", "id": "button_text_color", "label": "Button text", "default": "#014c3e" },
    { "type": "color", "id": "button_border_color", "label": "Button border", "default": "#d9edcf" },
    { "type": "color", "id": "button_bg_hover_color", "label": "Button background hover", "default": "#cde5c0" },
    { "type": "color", "id": "button_text_hover_color", "label": "Button text hover", "default": "#014c3e" },
    { "type": "color", "id": "button_border_hover_color", "label": "Button border hover", "default": "#cde5c0" },
    { "type": "text", "id": "shield_text", "label": "Shield line", "default": "30-day money back guarantee" },
    { "type": "range", "id": "shield_icon_size", "min": 12, "max": 28, "step": 1, "unit": "px", "label": "Shield icon size", "default": 18 },
    { "type": "range", "id": "shield_text_size", "min": 10, "max": 20, "step": 1, "unit": "px", "label": "Shield text size", "default": 14 },

    { "type": "header", "content": "Background" },
    { "type": "color", "id": "bg_color_fallback", "label": "Fallback background", "default": "#014c3e" },
    { "type": "color", "id": "bg_color_top", "label": "Gradient top", "default": "#014c3e" },
    { "type": "color", "id": "bg_color_bottom", "label": "Gradient bottom", "default": "#016450" },
    { "type": "image_picker", "id": "bg_image", "label": "Background image" },
    { "type": "select", "id": "bg_image_size", "label": "Background image size", "default": "cover", "options": [
      { "value": "cover", "label": "Cover" },
      { "value": "contain", "label": "Contain" },
      { "value": "auto", "label": "Auto" }
    ] },
    { "type": "select", "id": "bg_image_position", "label": "Background image position", "default": "center center", "options": [
      { "value": "left top", "label": "Left top" },
      { "value": "center top", "label": "Center top" },
      { "value": "right top", "label": "Right top" },
      { "value": "left center", "label": "Left center" },
      { "value": "center center", "label": "Center center" },
      { "value": "right center", "label": "Right center" },
      { "value": "left bottom", "label": "Left bottom" },
      { "value": "center bottom", "label": "Center bottom" },
      { "value": "right bottom", "label": "Right bottom" }
    ] },
    { "type": "color", "id": "overlay_color", "label": "Overlay color", "default": "#014c3e" },
    { "type": "range", "id": "overlay_opacity", "min": 0, "max": 100, "step": 1, "unit": "%", "label": "Overlay opacity", "default": 40 },

    { "type": "header", "content": "Layout" },
    { "type": "select", "id": "mobile_content_order", "label": "Mobile order", "default": "cta_first", "options": [
      { "value": "cta_first", "label": "CTA first" },
      { "value": "stats_first", "label": "Stats first" }
    ] },
    { "type": "range", "id": "stats_column_width", "min": 45, "max": 70, "step": 1, "unit": "%", "label": "Stats column width (desktop)", "default": 55 },
    { "type": "range", "id": "layout_gap_desktop", "min": 16, "max": 120, "step": 2, "unit": "px", "label": "Columns gap (desktop)", "default": 62 },
    { "type": "range", "id": "stats_column_gap", "min": 8, "max": 80, "step": 2, "unit": "px", "label": "Stats column gap", "default": 40 },
    { "type": "range", "id": "stat_padding_vertical", "min": 4, "max": 40, "step": 1, "unit": "px", "label": "Stat vertical spacing", "default": 13 },
    { "type": "range", "id": "padding_top_mobile", "min": 0, "max": 120, "step": 2, "unit": "px", "label": "Top padding (mobile)", "default": 40 },
    { "type": "range", "id": "padding_bottom_mobile", "min": 0, "max": 120, "step": 2, "unit": "px", "label": "Bottom padding (mobile)", "default": 40 },
    { "type": "range", "id": "padding_top_desktop", "min": 0, "max": 160, "step": 2, "unit": "px", "label": "Top padding (desktop)", "default": 80 },
    { "type": "range", "id": "padding_bottom_desktop", "min": 0, "max": 180, "step": 2, "unit": "px", "label": "Bottom padding (desktop)", "default": 80 },

    { "type": "header", "content": "Colors" },
    { "type": "color", "id": "text_color", "label": "Text color", "default": "#ffffff" },
    { "type": "color", "id": "percent_color", "label": "Percent color", "default": "#e3ffde" },
    { "type": "color", "id": "heading_color", "label": "Stat heading color", "default": "#ffffff" },
    { "type": "color", "id": "caption_color", "label": "Stat caption color", "default": "#ffffff" },
    { "type": "color", "id": "cta_title_color", "label": "CTA title color", "default": "#ffffff" },
    { "type": "color", "id": "cta_title_accent_color", "label": "CTA title accent color", "default": "#e3ffde" },
    { "type": "color", "id": "cta_subtitle_color", "label": "CTA subtitle color", "default": "#ffffff" },
    { "type": "color", "id": "shield_text_color", "label": "Shield text color", "default": "#ffffff" },
    { "type": "color", "id": "divider_color", "label": "Divider color", "default": "#ffffff" },
    { "type": "range", "id": "divider_opacity", "min": 0, "max": 100, "step": 1, "unit": "%", "label": "Divider opacity", "default": 35 },

    { "type": "header", "content": "Typography" },
    { "type": "range", "id": "percent_size_desktop", "min": 24, "max": 72, "step": 1, "unit": "px", "label": "Percent size (desktop)", "default": 40 },
    { "type": "range", "id": "percent_size_mobile", "min": 22, "max": 56, "step": 1, "unit": "px", "label": "Percent size (mobile)", "default": 36 },
    { "type": "range", "id": "stat_heading_size", "min": 12, "max": 30, "step": 1, "unit": "px", "label": "Stat heading size", "default": 16 },
    { "type": "range", "id": "stat_caption_size", "min": 11, "max": 24, "step": 1, "unit": "px", "label": "Stat caption size", "default": 15 },

    { "type": "header", "content": "CTA alignment" },
    { "type": "select", "id": "cta_text_align_desktop", "label": "CTA text align (desktop)", "default": "center", "options": [
      { "value": "left", "label": "Left" },
      { "value": "center", "label": "Center" },
      { "value": "right", "label": "Right" }
    ] },
    { "type": "select", "id": "cta_text_align_mobile", "label": "CTA text align (mobile)", "default": "left", "options": [
      { "value": "left", "label": "Left" },
      { "value": "center", "label": "Center" },
      { "value": "right", "label": "Right" }
    ] },

    { "type": "header", "content": "Counter animation" },
    { "type": "checkbox", "id": "enable_count_animation", "label": "Enable count animation", "default": true },
    { "type": "range", "id": "animation_duration", "min": 300, "max": 3000, "step": 100, "unit": "ms", "label": "Animation duration", "default": 1000 },
    { "type": "range", "id": "animation_threshold", "min": 10, "max": 100, "step": 5, "unit": "%", "label": "Animation trigger visibility", "default": 50 }
  ],
  "blocks": [
    {
      "type": "stat",
      "name": "Stat",
      "settings": [
        { "type": "range", "id": "percent", "label": "Percent", "min": 1, "max": 100, "step": 1, "unit": "%", "default": 94 },
        { "type": "text", "id": "heading", "label": "Heading", "default": "Said they felt fewer sick days" },
        { "type": "text", "id": "caption", "label": "Caption", "default": "after taking Resilia consistently for 2+ weeks" }
      ]
    }
  ],
  "max_blocks": 4,
  "presets": [
    {
      "name": "Clinical Proven Stats",
      "blocks": [
        {
          "type": "stat",
          "settings": {
            "percent": 94,
            "heading": "Said they felt fewer sick days",
            "caption": "after taking Resilia consistently for 2+ weeks"
          }
        },
        {
          "type": "stat",
          "settings": {
            "percent": 96,
            "heading": "Would recommend Resilia to a friend",
            "caption": "for natural immune and gut support"
          }
        },
        {
          "type": "stat",
          "settings": {
            "percent": 92,
            "heading": "Noticed improved digestion and less bloating",
            "caption": "especially after meals"
          }
        },
        {
          "type": "stat",
          "settings": {
            "percent": 89,
            "heading": "Said they prefer Resilia's formula",
            "caption": "over other oregano supplements they have tried"
          }
        }
      ]
    }
  ]
}
{% endschema %}