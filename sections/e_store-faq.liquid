

<!-- Apply mobile fonts immediately on page load -->
<script>
  (function() {
    if (window.innerWidth < 750) {
      document.documentElement.classList.add('faq-mobile-view');
    }
  })();
</script>

<div class="store-faq-section" style="
  padding-top: {{ section.settings.section_padding }}px;
  padding-bottom: {{ section.settings.section_padding }}px;
  background-color: {% if section.settings.use_theme_colors %}{{ settings.global_section_background_color }}{% else %}{{ section.settings.section_bg_color }}{% endif %} !important;
">
  <div class="store-faq-container" style="
    width: 100%;
    max-width: 1200px;
    padding-left: 15px;
    padding-right: 15px;
    margin: 0 auto;
  ">
    <div class="page-width faq-flex-container">
      <div class="faq-header-column">
        {% if section.settings.heading != blank %}
          <h2 class="store-faq-heading" style="color: {% if section.settings.use_theme_colors %}{{ settings.global_section_text_color }}{% else %}{{ section.settings.heading_color }}{% endif %} !important; font-size: {{ section.settings.heading_font_size }}px;">
            {{ section.settings.heading }}
          </h2>
        {% endif %}
        
        {% if section.settings.subtitle != blank %}
          <div class="store-faq-subtitle" style="color: {% if section.settings.use_theme_colors %}{{ settings.global_section_text_color }}{% else %}{{ section.settings.heading_color | color_modify: 'alpha', 0.8 }}{% endif %} !important; font-size: {{ section.settings.subtitle_font_size }}px;">
            {{ section.settings.subtitle }}
          </div>
        {% endif %}
      </div>
      
      <div class="faq-content-column">
        <div class="store-faq" 
          id="store-faq-{{ section.id }}"
          style="
            width: 100%;
            margin: 0 auto;
          "
        >
          <div class="faq-container"
            style="
              border-radius: {{ section.settings.border_radius }}px;
              border-color: {% if section.settings.use_theme_colors %}#E5E5E5{% else %}{{ section.settings.border_color }}{% endif %} !important;
              border: 1px solid {% if section.settings.use_theme_colors %}#E5E5E5{% else %}{{ section.settings.border_color }}{% endif %} !important;
            "
            data-accordion="{{ section.settings.accordion_mode }}"
          >
            {% for block in section.blocks %}
              {% case block.type %}
                {% when 'faq_item' %}
                  <div class="faq-item" {{ block.shopify_attributes }} style="border-bottom: 1px solid {% if section.settings.use_theme_colors %}#E5E5E5{% else %}{{ section.settings.border_color }}{% endif %} !important;">
                    <div class="faq-question" style="
                      color: {% if section.settings.use_theme_colors %}{{ settings.global_section_text_color }}{% else %}{{ section.settings.question_color }}{% endif %} !important;
                      background-color: {% if section.settings.use_theme_colors %}{{ settings.global_section_background_color }}{% else %}{{ section.settings.question_bg_color }}{% endif %} !important;
                    ">
                      <span>{{ block.settings.question }}</span>
                      <span class="faq-toggle">+</span>
                    </div>
                    <div class="faq-answer" style="
                      color: {% if section.settings.use_theme_colors %}{{ settings.global_section_text_color }}{% else %}{{ section.settings.answer_color }}{% endif %} !important;
                      background-color: {% if section.settings.use_theme_colors %}{{ settings.global_section_background_color }}{% else %}{{ section.settings.answer_bg_color }}{% endif %} !important;
                    ">
                      {{ block.settings.answer }}
                    </div>
                  </div>
              {% endcase %}
            {% endfor %}
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
  .store-faq-section {
    padding: {{ section.settings.section_padding }}px 0;
    overflow-x: hidden; /* Prevent horizontal overflow at section level */
  }
  
  .store-faq-container {
    width: 100%;
    max-width: 1200px; /* Set max-width here instead of inline */
    margin: 0 auto;
    padding-left: 15px;
    padding-right: 15px;
    box-sizing: border-box;
  }
  
  .faq-flex-container {
    display: flex;
    flex-direction: column;
    width: 100%;
    max-width: 100%;
  }
  
  .faq-header-column {
    margin-bottom: 30px;
    width: 100%;
    max-width: 100%;
  }
  
  .faq-content-column {
    width: 100%;
    max-width: 100%;
  }
  
  .store-faq-heading {
    margin-bottom: 15px;
    letter-spacing: var(--letter-spacing-heading);
    font-size: {{ section.settings.heading_font_size }}px;
    word-wrap: break-word;
    overflow-wrap: break-word;
  }
  
  .store-faq-subtitle {
    line-height: 1.5;
    max-width: 90%;
    font-weight: var(--font-weight-regular);
    letter-spacing: var(--letter-spacing-body);
    word-wrap: break-word;
    overflow-wrap: break-word;
  }
  
  .store-faq {
    width: 100%;
    max-width: 100%;
    box-sizing: border-box;
  }
  
  .store-faq .faq-container {
    overflow: hidden;
    width: 100%;
    max-width: 100%;
    box-sizing: border-box;
  }
  
  .store-faq .faq-item {
    width: 100%;
    box-sizing: border-box;
  }
  
  .store-faq .faq-item:last-child {
    border-bottom: none !important;
  }
  
  .store-faq .faq-question {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px 20px;
    cursor: pointer;
    font-weight: 500;
    position: relative;
    font-size: {{ section.settings.question_font_size }}px;
    width: 100%;
    box-sizing: border-box;
    word-wrap: break-word;
    overflow-wrap: break-word;
  }
  
  .store-faq .faq-question span {
    word-wrap: break-word;
    overflow-wrap: break-word;
    word-break: break-word; /* Allow breaking at any character if needed */
    max-width: calc(100% - 30px); /* Leave room for toggle */
  }
  
  .store-faq .faq-toggle {
    font-size: 20px;
    font-weight: 300;
    transition: transform 0.3s ease;
    flex-shrink: 0;
    display: block;
    width: 20px;
    text-align: center;
  }
  
  .store-faq .faq-answer {
    padding: 0 20px;
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease, padding 0.3s ease;
    font-size: {{ section.settings.answer_font_size }}px;
    width: 100%;
    box-sizing: border-box;
    word-wrap: break-word;
    overflow-wrap: break-word;
    word-break: break-word; /* For extremely long strings */
  }
  
  .store-faq .faq-item.active .faq-toggle {
    transform: rotate(45deg);
  }
  
  .store-faq .faq-item.active .faq-answer {
    max-height: 300px; /* Reduced for better mobile experience */
    overflow-y: auto;
    overflow-x: hidden;
    padding: 0 20px 16px;
    box-sizing: border-box;
  }
  
  /* Target all possible children of faq-answer */
  .store-faq .faq-answer > * {
    max-width: 100%;
    word-wrap: break-word;
    overflow-wrap: break-word;
    word-break: break-word; /* Handle extremely long strings */
    box-sizing: border-box;
  }
  
  .store-faq .faq-answer p {
    max-width: 100%;
    word-wrap: break-word;
    overflow-wrap: break-word;
    word-break: break-word; /* For extremely long strings */
    margin-top: 0;
    margin-bottom: 1em;
  }
  
  .store-faq .faq-answer p:last-child {
    margin-bottom: 0;
  }
  
  /* Apply mobile styles when the faq-mobile-view class is present */
  .faq-mobile-view .store-faq .faq-question {
    font-size: {{ section.settings.question_font_size_mobile }}px !important;
  }
  
  .faq-mobile-view .store-faq .faq-answer {
    font-size: {{ section.settings.answer_font_size_mobile }}px !important;
  }
  
  @media screen and (min-width: 750px) {
    .faq-flex-container {
      flex-direction: row;
      align-items: flex-start;
      gap: 40px;
    }
    
    .faq-header-column {
      flex: 0 0 48%;
      margin-bottom: 0;
      padding-top: 20px;
      max-width: 48%;
    }
    
    .faq-content-column {
      flex: 0 0 48%;
      display: flex;
      justify-content: center;
      max-width: 48%;
    }
    
    .store-faq {
      width: 100%;
    }
    
    .store-faq .faq-question {
      padding: 13px 17px;
    }
    
    .store-faq .faq-toggle {
      font-size: 17px;
    }
    
    .store-faq .faq-answer {
      padding: 0 17px;
    }
    
    .store-faq .faq-item.active .faq-answer {
      padding: 0 17px 14px;
      max-height: 400px; /* Slightly larger on desktop */
    }
  }
  
  @media screen and (max-width: 749px) {
    .store-faq-section {
      padding: {{ section.settings.section_padding | divided_by: 1.5 }}px 0;
    }
    
    .faq-header-column {
      text-align: center;
      margin-left: auto;
      margin-right: auto;
    }
    
    .store-faq-heading {
      font-size: {{ section.settings.heading_font_size_mobile }}px !important;
      line-height: 1.2;
      letter-spacing: var(--letter-spacing-heading);
    }
    
    .store-faq-subtitle {
      font-size: {{ section.settings.subtitle_font_size_mobile }}px !important;
      max-width: 100%;
      margin-left: auto;
      margin-right: auto;
    }
    
    .store-faq .faq-question {
      padding: 10px 12px;
      font-size: {{ section.settings.question_font_size_mobile }}px !important;
    }
    
    .store-faq .faq-question.mobile-font {
      font-size: {{ section.settings.question_font_size_mobile }}px !important;
    }
    
    .store-faq .faq-toggle {
      font-size: 18px;
    }
    
    .store-faq .faq-answer {
      font-size: {{ section.settings.answer_font_size_mobile }}px !important;
    }
    
    .store-faq .faq-answer.mobile-font {
      font-size: {{ section.settings.answer_font_size_mobile }}px !important;
    }
    
    .store-faq .faq-item.active .faq-answer {
      padding: 0 12px 10px;
    }
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const faqContainer = document.querySelector('#store-faq-{{ section.id }}');
    if (!faqContainer) return;
    
    const faqItems = faqContainer.querySelectorAll('.faq-item');
    const isAccordion = faqContainer.querySelector('.faq-container').getAttribute('data-accordion') === 'true';
    
    // Set initial styles for answers so they get proper padding when activated
    faqItems.forEach(item => {
      const answer = item.querySelector('.faq-answer');
      // Store original padding values to restore when active
      answer.setAttribute('data-padding-active', '0 20px 16px');
      answer.setAttribute('data-padding-mobile-active', '0 12px 10px');
      
      const question = item.querySelector('.faq-question');
      
      question.addEventListener('click', () => {
        const isActive = item.classList.contains('active');
        
        // Close all other items first if accordion mode is enabled
        if (isAccordion && !isActive) {
          faqItems.forEach(otherItem => {
            otherItem.classList.remove('active');
          });
        }
        
        // Toggle the clicked item
        item.classList.toggle('active');
      });
    });
    
    // Handle responsive font sizes
    function updateResponsiveFontSizes() {
      const isMobile = window.innerWidth < 750;
      
      // Apply/remove mobile class at the document level
      if (isMobile) {
        document.documentElement.classList.add('faq-mobile-view');
      } else {
        document.documentElement.classList.remove('faq-mobile-view');
      }
      
      // Apply/remove mobile class for each element
      const questions = faqContainer.querySelectorAll('.faq-question');
      const answers = faqContainer.querySelectorAll('.faq-answer');
      
      questions.forEach(question => {
        if (isMobile) {
          question.classList.add('mobile-font');
        } else {
          question.classList.remove('mobile-font');
        }
      });
      
      answers.forEach(answer => {
        if (isMobile) {
          answer.classList.add('mobile-font');
        } else {
          answer.classList.remove('mobile-font');
        }
      });
    }
    
    // Initial call and add resize listener
    updateResponsiveFontSizes();
    window.addEventListener('resize', updateResponsiveFontSizes);
  });
</script>

{% schema %}
{
  "name": "Store FAQ",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "checkbox",
      "id": "use_theme_colors",
      "label": "Use Theme Colors",
      "default": true,
      "info": "Apply the global theme colors to this section"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Frequently Asked Questions"
    },
    {
      "type": "richtext",
      "id": "subtitle",
      "label": "Subtitle",
      "default": "<p>Find answers to common questions about our products, shipping, returns, and more.</p>"
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading color",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "section_padding",
      "min": 20,
      "max": 100,
      "step": 10,
      "default": 60,
      "label": "Section padding (px)"
    },
    {
      "type": "color",
      "id": "section_bg_color",
      "label": "Section background",
      "default": "#FFFFFF"
    },
    {
      "type": "range",
      "id": "border_radius",
      "min": 0,
      "max": 20,
      "step": 1,
      "default": 8,
      "label": "Border radius (px)"
    },
    {
      "type": "color",
      "id": "border_color",
      "label": "Border color",
      "default": "#e5e5e5"
    },
    {
      "type": "header",
      "content": "Questions and Answers"
    },
    {
      "type": "color",
      "id": "question_color",
      "label": "Question text color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "question_bg_color",
      "label": "Question background color",
      "default": "#FFFFFF"
    },
    {
      "type": "color",
      "id": "answer_color",
      "label": "Answer text color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "answer_bg_color",
      "label": "Answer background color",
      "default": "#FFFFFF"
    },
    {
      "type": "checkbox",
      "id": "accordion_mode",
      "label": "Accordion mode (only one answer open at a time)",
      "default": true
    },
    {
      "type": "header",
      "content": "Typography"
    },
    {
      "type": "range",
      "id": "heading_font_size",
      "min": 24,
      "max": 60,
      "step": 2,
      "unit": "px",
      "label": "Heading font size (desktop)",
      "default": 36
    },
    {
      "type": "range",
      "id": "heading_font_size_mobile",
      "min": 20,
      "max": 48,
      "step": 2,
      "unit": "px",
      "label": "Heading font size (mobile)",
      "default": 30
    },
    {
      "type": "range",
      "id": "subtitle_font_size",
      "min": 12,
      "max": 28,
      "step": 1,
      "unit": "px",
      "label": "Subtitle font size (desktop)",
      "default": 16
    },
    {
      "type": "range",
      "id": "subtitle_font_size_mobile",
      "min": 10,
      "max": 22,
      "step": 1,
      "unit": "px",
      "label": "Subtitle font size (mobile)",
      "default": 14
    },
    {
      "type": "range",
      "id": "question_font_size",
      "min": 12,
      "max": 24,
      "step": 1,
      "unit": "px",
      "label": "Question font size (desktop)",
      "default": 16
    },
    {
      "type": "range",
      "id": "question_font_size_mobile",
      "min": 10,
      "max": 20,
      "step": 1,
      "unit": "px",
      "label": "Question font size (mobile)",
      "default": 14
    },
    {
      "type": "range",
      "id": "answer_font_size",
      "min": 12,
      "max": 22,
      "step": 1,
      "unit": "px",
      "label": "Answer font size (desktop)",
      "default": 14
    },
    {
      "type": "range",
      "id": "answer_font_size_mobile",
      "min": 10,
      "max": 18,
      "step": 1,
      "unit": "px",
      "label": "Answer font size (mobile)",
      "default": 13
    }
  ],
  "blocks": [
    {
      "type": "faq_item",
      "name": "FAQ Item",
      "settings": [
        {
          "type": "text",
          "id": "question",
          "label": "Question",
          "default": "How do I place an order?"
        },
        {
          "type": "richtext",
          "id": "answer",
          "label": "Answer",
          "default": "<p>To place an order, simply browse our products, add items to your cart, and proceed to checkout. You can review your order before finalizing your purchase.</p>"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Store FAQ",
      "blocks": [
        {
          "type": "faq_item"
        },
        {
          "type": "faq_item",
          "settings": {
            "question": "What payment methods do you accept?",
            "answer": "<p>We accept major credit cards, PayPal, Shop Pay, and Apple Pay for your convenience and security.</p>"
          }
        },
        {
          "type": "faq_item",
          "settings": {
            "question": "How long does shipping take?",
            "answer": "<p>Standard shipping typically takes 3-5 business days within the continental US. International shipping times vary by location.</p>"
          }
        },
        {
          "type": "faq_item",
          "settings": {
            "question": "What is your return policy?",
            "answer": "<p>We offer a 30-day return policy. If you're not satisfied with your purchase, you can return it within 30 days for a full refund or exchange.</p>"
          }
        }
      ]
    }
  ]
}
{% endschema %} 